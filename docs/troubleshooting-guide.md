# トラブルシューティングガイド

## 概要

このガイドでは、OpenWAM Webアプリケーションの使用中に発生する可能性のある問題と、その解決方法について説明します。

## 目次

1. [アプリケーション起動の問題](#アプリケーション起動の問題)
2. [モデル作成・編集の問題](#モデル作成編集の問題)
3. [シミュレーション実行の問題](#シミュレーション実行の問題)
4. [ファイル操作の問題](#ファイル操作の問題)
5. [パフォーマンスの問題](#パフォーマンスの問題)
6. [ブラウザ関連の問題](#ブラウザ関連の問題)
7. [エラーメッセージ一覧](#エラーメッセージ一覧)

## アプリケーション起動の問題

### アプリケーションが起動しない

**症状**: アプリケーションを起動してもブラウザでアクセスできない

**原因と対処法**:

1. **ポートが使用中**
   ```
   エラー: Port 3000 is already in use
   ```
   - **対処法**: 他のアプリケーションを終了するか、別のポートを使用
   - 設定ファイルでポート番号を変更可能

2. **権限不足**
   ```
   エラー: Permission denied
   ```
   - **対処法**: 管理者権限で実行
   - ファイルの読み書き権限を確認

3. **依存関係の問題**
   ```
   エラー: Module not found
   ```
   - **対処法**: `npm install` で依存関係を再インストール
   - Node.jsのバージョンを確認（推奨: v18以上）

### ブラウザでページが表示されない

**症状**: `http://localhost:3000` にアクセスしても何も表示されない

**対処法**:

1. **サーバーの状態確認**
   - コンソールでエラーメッセージを確認
   - サーバーが正常に起動しているか確認

2. **ファイアウォール設定**
   - ローカルホストへのアクセスが許可されているか確認
   - セキュリティソフトの設定を確認

3. **ブラウザのキャッシュクリア**
   - ブラウザのキャッシュとCookieをクリア
   - プライベートブラウジングモードで試行

## モデル作成・編集の問題

### コンポーネントが配置できない

**症状**: コンポーネントパレットからコンポーネントを選択してもキャンバスに配置できない

**対処法**:

1. **ブラウザの互換性確認**
   - 対応ブラウザ（Chrome, Firefox, Safari, Edge）を使用
   - JavaScriptが有効になっているか確認

2. **キャンバスの状態確認**
   - キャンバスが正しく初期化されているか確認
   - ページを再読み込み

3. **マウス操作の確認**
   - コンポーネント選択後、キャンバス上でクリック
   - ドラッグ&ドロップではなくクリックで配置

### コンポーネントの接続ができない

**症状**: 接続ツールを使ってもコンポーネント同士が接続されない

**対処法**:

1. **接続ルールの確認**
   - 接続可能なコンポーネントの組み合わせか確認
   - [コンポーネントリファレンス](component-reference.md)で接続ルールを確認

2. **接続点の確認**
   - 正しい接続点をクリックしているか確認
   - 接続点が緑色に変化することを確認

3. **接続順序の確認**
   - 出力側から入力側の順序で接続
   - 双方向接続の場合は順序は問わない

### プロパティが保存されない

**症状**: コンポーネントのプロパティを変更しても保存されない

**対処法**:

1. **入力値の検証**
   - 入力値が有効な範囲内か確認
   - エラーメッセージが表示されていないか確認

2. **フォーカスの移動**
   - 入力後、他の要素をクリックしてフォーカスを移動
   - EnterキーまたはTabキーで入力を確定

3. **プロジェクトの保存**
   - Ctrl+Sでプロジェクトを明示的に保存
   - 自動保存が有効になっているか確認

## シミュレーション実行の問題

### シミュレーションが開始されない

**症状**: 「シミュレーション実行」ボタンを押してもシミュレーションが開始されない

**対処法**:

1. **モデルの検証**
   - モデル検証を実行してエラーがないか確認
   - 必要な境界条件が設定されているか確認

2. **OpenWAM実行ファイルの確認**
   - OpenWAM実行ファイルが正しいパスに配置されているか確認
   - 実行権限が設定されているか確認

3. **入力ファイルの生成**
   - WAMファイルが正しく生成されているか確認
   - ファイルの書き込み権限があるか確認

### シミュレーションが途中で停止する

**症状**: シミュレーションが開始されるが途中で停止してしまう

**対処法**:

1. **収束問題**
   ```
   エラー: Convergence failed at time step X
   ```
   - 時間刻み（角度増分）を小さくする
   - 初期条件を調整する
   - 境界条件の妥当性を確認

2. **メモリ不足**
   ```
   エラー: Out of memory
   ```
   - 計算セル数を減らす
   - 不要なコンポーネントを削除
   - システムメモリを増設

3. **数値不安定性**
   ```
   エラー: Numerical instability detected
   ```
   - CFL条件を満たすよう時間刻みを調整
   - メッシュサイズを見直す
   - 境界条件の急激な変化を緩和

### 結果が非物理的

**症状**: シミュレーション結果が物理的に不合理

**対処法**:

1. **パラメータの確認**
   - 入力パラメータの単位と値を確認
   - 物理的に妥当な範囲内か確認

2. **モデル構造の見直し**
   - コンポーネントの接続が正しいか確認
   - 境界条件の設定が適切か確認

3. **初期条件の調整**
   - 初期圧力・温度が適切か確認
   - 初期流速が妥当か確認

## ファイル操作の問題

### ファイルのアップロードができない

**症状**: WAMファイルをアップロードしようとするとエラーが発生

**対処法**:

1. **ファイル形式の確認**
   - ファイル拡張子が.wamか確認
   - ファイルの内容が正しいWAM形式か確認

2. **ファイルサイズの確認**
   - ファイルサイズが制限（10MB）以下か確認
   - 不要なデータを削除してサイズを削減

3. **ファイルの権限確認**
   - ファイルが読み取り可能か確認
   - 他のアプリケーションで使用中でないか確認

### ファイルのダウンロードができない

**症状**: 結果ファイルやモデルファイルのダウンロードが失敗する

**対処法**:

1. **ブラウザの設定確認**
   - ダウンロード先フォルダの権限を確認
   - ポップアップブロッカーを無効化

2. **ファイルの存在確認**
   - サーバー上にファイルが存在するか確認
   - ファイル生成が完了しているか確認

3. **ネットワーク接続確認**
   - ローカルネットワークの接続を確認
   - ファイアウォールの設定を確認

### WAMファイルの解析エラー

**症状**: アップロードしたWAMファイルの解析に失敗する

**対処法**:

1. **ファイル形式の確認**
   ```
   エラー: Invalid WAM file format
   ```
   - OpenWAM標準形式に準拠しているか確認
   - 文字エンコーディングを確認（UTF-8推奨）

2. **ファイル内容の確認**
   ```
   エラー: Missing required sections
   ```
   - 必要なセクションが全て含まれているか確認
   - データの整合性を確認

3. **バージョン互換性**
   ```
   エラー: Unsupported OpenWAM version
   ```
   - 対応するOpenWAMバージョンか確認
   - 必要に応じてファイルを変換

## パフォーマンスの問題

### アプリケーションの動作が重い

**症状**: ユーザーインターフェースの応答が遅い

**対処法**:

1. **ブラウザの最適化**
   - 不要なタブを閉じる
   - ブラウザを再起動
   - ハードウェアアクセラレーションを有効化

2. **モデルの最適化**
   - 不要なコンポーネントを削除
   - 計算セル数を適切に設定
   - 複雑な接続を簡略化

3. **システムリソース**
   - メモリ使用量を確認
   - CPUの負荷を確認
   - 他のアプリケーションを終了

### シミュレーションが遅い

**症状**: シミュレーション実行に非常に時間がかかる

**対処法**:

1. **計算条件の最適化**
   - 時間刻みを適切に設定
   - シミュレーション時間を短縮
   - 収束判定基準を調整

2. **並列計算の活用**
   - OpenMP並列化を有効化
   - CPUコア数に応じた設定
   - メモリ帯域幅の確認

3. **モデルの簡略化**
   - 不要な詳細を省略
   - 対称性を利用した簡略化
   - 境界条件の簡素化

## ブラウザ関連の問題

### 表示が崩れる

**症状**: ユーザーインターフェースのレイアウトが正しく表示されない

**対処法**:

1. **ブラウザの更新**
   - 最新バージョンに更新
   - 対応ブラウザを使用

2. **画面解像度の確認**
   - 推奨解像度（1280x720以上）を使用
   - ズームレベルを100%に設定

3. **CSS・JavaScriptの確認**
   - 開発者ツールでエラーを確認
   - キャッシュをクリア

### キーボードショートカットが効かない

**症状**: Ctrl+S等のショートカットが機能しない

**対処法**:

1. **フォーカスの確認**
   - アプリケーション画面にフォーカスがあるか確認
   - 入力フィールド以外をクリック

2. **ブラウザ設定の確認**
   - ブラウザのショートカットと競合していないか確認
   - 拡張機能の影響を確認

3. **代替操作の使用**
   - メニューボタンから同じ機能を実行
   - マウス操作で代替

## エラーメッセージ一覧

### システムエラー

| エラーコード | メッセージ | 原因 | 対処法 |
|-------------|-----------|------|--------|
| SYS001 | Server connection failed | サーバー接続エラー | サーバーの再起動 |
| SYS002 | Database error | データベースエラー | データベースの修復 |
| SYS003 | File system error | ファイルシステムエラー | 権限・容量の確認 |

### モデルエラー

| エラーコード | メッセージ | 原因 | 対処法 |
|-------------|-----------|------|--------|
| MDL001 | Invalid component connection | 無効な接続 | 接続ルールの確認 |
| MDL002 | Missing boundary conditions | 境界条件不足 | 境界条件の追加 |
| MDL003 | Circular reference detected | 循環参照 | 接続の見直し |
| MDL004 | Isolated components found | 孤立コンポーネント | 接続の追加 |

### シミュレーションエラー

| エラーコード | メッセージ | 原因 | 対処法 |
|-------------|-----------|------|--------|
| SIM001 | Convergence failed | 収束失敗 | 時間刻みの調整 |
| SIM002 | Numerical instability | 数値不安定性 | CFL条件の確認 |
| SIM003 | Memory allocation failed | メモリ不足 | メモリの増設 |
| SIM004 | OpenWAM execution failed | OpenWAM実行失敗 | 実行ファイルの確認 |

### ファイルエラー

| エラーコード | メッセージ | 原因 | 対処法 |
|-------------|-----------|------|--------|
| FIL001 | File not found | ファイル未発見 | ファイルパスの確認 |
| FIL002 | Invalid file format | 無効なファイル形式 | ファイル形式の確認 |
| FIL003 | File size too large | ファイルサイズ超過 | ファイルサイズの削減 |
| FIL004 | Permission denied | 権限不足 | ファイル権限の確認 |

## 問題解決のフローチャート

```
問題発生
    ↓
エラーメッセージの確認
    ↓
該当するカテゴリの確認
    ├─ システム関連 → システムエラーの対処法
    ├─ モデル関連 → モデルエラーの対処法
    ├─ シミュレーション関連 → シミュレーションエラーの対処法
    └─ ファイル関連 → ファイルエラーの対処法
    ↓
対処法の実行
    ↓
問題解決？
    ├─ Yes → 完了
    └─ No → 詳細ログの確認・サポートへ連絡
```

## ログファイルの確認方法

### アプリケーションログ

1. **ログファイルの場所**
   - `logs/combined.log`: 全般的なログ
   - `logs/error.log`: エラーログのみ

2. **ログレベル**
   - ERROR: エラー情報
   - WARN: 警告情報
   - INFO: 一般情報
   - DEBUG: デバッグ情報

3. **ログの読み方**
   ```
   [2024-01-01 10:00:00] ERROR: SIM001 - Convergence failed at time step 0.25
   ```
   - タイムスタンプ
   - ログレベル
   - エラーコード
   - 詳細メッセージ

### ブラウザの開発者ツール

1. **開発者ツールの開き方**
   - Chrome/Edge: F12キー
   - Firefox: F12キー
   - Safari: Cmd+Option+I

2. **コンソールタブの確認**
   - JavaScriptエラーの確認
   - ネットワークエラーの確認
   - 警告メッセージの確認

## サポートへの連絡方法

問題が解決しない場合は、以下の情報を含めてサポートに連絡してください：

### 必要な情報

1. **環境情報**
   - OS（Windows/macOS/Linux）
   - ブラウザ（種類・バージョン）
   - アプリケーションバージョン

2. **問題の詳細**
   - 発生した問題の具体的な症状
   - 問題が発生する手順
   - エラーメッセージ（スクリーンショット含む）

3. **ログファイル**
   - アプリケーションログ
   - ブラウザのコンソールログ
   - 関連するファイル

### 連絡先

- **GitHub Issues**: バグレポート・機能要望
- **ユーザーフォーラム**: 一般的な質問・議論
- **メール**: 緊急の問題・セキュリティ関連

---

このガイドで解決しない問題については、詳細な情報と共にサポートまでご連絡ください。