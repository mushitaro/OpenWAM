# ドキュメント更新仕様書 (Documentation Update Policy)

## 1. 目的 (Objective)

このドキュメントは、本プロジェクトにおける開発の進捗と各種ドキュメント間の整合性を維持し、AI開発エージェント（Gemini）を含む全ての開発者が、常に最新の状況を正確に把握できるようにするための更新ポリシーを定めるものです。

コードの変更は、必ず関連するドキュメントに反映されなければなりません。

## 2. 更新の基本原則 (Core Principles)

- **コードとドキュメントの同期:** すべてのコード変更は、関連するドキュメントに反映されるべきです。ドキュメントは「信頼できる唯一の情報源（Single Source of Truth）」として機能します。
- **変更の意図を記録:** 「何を変更したか」だけでなく、「なぜその変更を行ったのか」という背景や目的を記録することが、将来のメンテナンス性向上に繋がります。
- **AIエージェントへの情報提供:** 更新は、AIエージェントが文脈を理解し、次のタスクを円滑に遂行できるような、明確かつ構造化された形式で行います。

## 3. ドキュメント別 更新仕様

開発作業の内容に応じて、以下の通り対応するドキュメントを更新してください。

### 3.1. `Specification.md` (C++コードベース仕様書)

- **更新タイミング:**
    - OpenWAMのC++ソースコード（`Source/`フォルダ内）のリファクタリングや機能追加・修正を行った場合。

- **更新内容:**
    1.  **既存コンポーネントの変更:**
        *   変更したクラスや関数のセクション（例: `### 25. TBloqueMotor, TCilindro`）を探します。
        *   メソッドの追加・削除・インターフェース変更があった場合は、「主要なメソッド」の項目を更新します。
        *   クラスの責務やデータ構造に変更があった場合は、「概要」「データ構造」の項目を更新します。
        *   リファクタリングによって問題点が改善された場合（例: 「手動メモリ管理を`std::unique_ptr`に置き換え」）、その内容を「特筆すべき設計と問題点」に反映させます。
    2.  **新規コンポーネントの追加:**
        *   既存のフォーマットに倣い、新しいコンポーネントのセクションを追記します。
        *   「概要」「主な責務」「データ構造」「主要なメソッド」「特筆すべき設計と問題点」の各項目を、コードの内容に基づき記述します。

### 3.2. `FUTURE_DEVELOPMENT.md` (開発ロードマップ)

- **更新タイミング:**
    - 開発のフェーズが完了、または次のフェーズに着手する場合。
    - 開発計画に大きな変更（優先順位の変更、新規タスクの追加など）があった場合。

- **更新内容:**
    1.  **進捗の反映:**
        *   完了したタスクには、明確に「**(完了)**」マークを付けます。
        *   現在進行中のフェーズやタスクに、「**(現在の焦点)**」マークを移動させます。
    2.  **計画の変更:**
        *   新しい機能のアイデアが生まれた場合、適切なフェーズに新しいタスクとして追記します。
        *   優先順位が変更された場合、タスクの順序を入れ替えるか、その旨を注記します。

### 3.3. Python関連ドキュメント

対象: `PYTHON_MODEL_DESIGN.md`, `BMW_E46_M3_*.md` など

- **更新タイミング:**
    - Pythonプロトタイプ（`engine_simulator/`内）の設計や仕様に大きな変更があった場合。

- **更新内容:**
    1.  **設計との同期:** Pythonコードの実装が、これらの設計書・仕様書から乖離した場合は、コードかドキュメントのどちらかを修正し、両者の整合性を保ちます。
    2.  **仕様の明確化:** 新しい計算ロジック（例: 体積効率の新たな補正係数）や、新しいデータソースを導入した場合、その仕様や根拠を対応するドキュメントに追記します。

## 4. 更新ワークフローの例

**シナリオ： `TCilindro`クラスの熱伝達モデルをリファクタリングした場合**

1.  **コード変更:** `Source/Engine/TCilindro.cpp`内の熱伝達計算ロジックを修正する。
2.  **仕様書更新:** `Specification.md`を開く。
    *   「25. TBloqueMotor, TCilindro」セクションに移動する。
    *   「主要なメソッド」セクションで、関連するメソッド（例: `ActualizaPropiedades`）の説明を、新しいロジックに合わせて更新する。
    *   「特筆すべき設計と問題点」セクションに、「Woschniモデルの計算を別クラスに分離し、可読性を向上」のように、改善点を追記する。
3.  **ロードマップ更新:** `FUTURE_DEVELOPMENT.md`を開く。
    *   「フェーズ2: 筒内熱力学モデルの詳細化」に移動する。
    *   タスク「熱損失モデル（Woschni）の実装」の項目に、進捗があったことを示す注記（例: 「リファクタリング実施」）を追加するか、完了マークを付ける。
